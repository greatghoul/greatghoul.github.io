---
slug: 46-runqian-notes
date: '2011-01-10'
layout: post
title: 润乾报表使用心得
tags:
  - Java
issue: 46
---

因为项目的需要，使用过不少报表软件，包括[帆软][fr]、[润乾][rq]、[e表][fc]、甚至还有中创的 InforReport ，个人感觉，其实帆软无论从功能还是易用性上来说，都是上品，润乾并没有广告中那样牛逼。e表相对比较便宜，但是对于一般的报表应用来说，已经十分出色了，至于 InforReport，虽然很烂，但是报表生成向导很不错。

经常说 **南帆软北润乾**，其实就如 **南慕容(润乾)北乔风(帆软)** 一般，个人理解，欢迎吐水。不过我们不得不佩服推广的重要性，润乾在这方面相当成功。

虽然不喜欢，对软件的偏见不能带到工作中，润乾还是得用，以下是对润乾报表使用的一些零散的经验，以后会经常补充和整理。

 1. **生成连续的日期序列：** 在做一些日期相关的统计时，可能会需要展示X月X日前后多少天的记录。这时可以设置一个不可见的
    扩展格如 `C2`，值为 `=to(m, n)` ，然后在要展示日期的的扩展格如 `C3` 中利用 `relDate` 函数生成连续日期 
    `=relDate(now(), C2)`
 2. **数据量太大造成 cell num exceeds limit 异常：** 在 `reportconfig.xml` 中的 `maxCellNum` 值调大一些。
 3. **设置只在纵向分页：** 修改展现报表的 JSP 页面，如 `showReport.jsp` 设置 `<report:html />`; 标签的 `width` 属性为
    `-1` ，并在报表属性中设置 **纸张方向** 为 **纵向** ，设置 **分页方式** 为 **按行分页**。

**PS: ** 可能很长一段时间之后才会再次接触润乾报表，现在已经转向 python 阵营，接触 java 就会相对少一些了，
本来打算慢慢总结出十条再放出来，结果现在却只有少得可怜的3条。

[fr]: http://www.finereport.com/
[rq]: http://www.runqian.com.cn/
[fc]: http://www.fcsoft.com.cn/
